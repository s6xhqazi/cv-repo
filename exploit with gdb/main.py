import gdb
import sys

def debugIt():
    gdb.execute('file xor', False, True)    #open the file
    gdb.execute("break *main+66", False, True)   #break at conition, $rbp-4 >= 6
    gdb.execute("r")		#run the programm
    for i in range (0,7):
    	gdb.execute("c", False, True)	#continue to run until rax value at the breakpoint has reached 6
    var3 = gdb.execute("x/s $rbp-12", False, True)	#read the saved decoded string
    var4 = var3.split('"')				#remove the unwanted parts of the string by spliting
    print(var4[1])				#read the value
    gdb.execute("q")				#close dbg
    

if __name__ == '__main__':	
    string = debugIt()
